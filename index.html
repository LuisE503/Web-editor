<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">
  <title>Redirecting...</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }
    
    .loader {
      text-align: center;
    }
    
    .spinner {
      width: 60px;
      height: 60px;
      margin: 0 auto 1.5rem;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    p {
      font-size: 1rem;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="loader">
    <div class="spinner" role="status" aria-label="Loading"></div>
    <h1>Loading...</h1>
    <p>Detecting your language preference...</p>
  </div>

  <script>
    /**
     * Language Detection & Automatic Redirection
     * Detects user's preferred language and redirects to the appropriate version
     */
    (function() {
      'use strict';
      
      // Supported languages with their codes
      const SUPPORTED_LANGUAGES = {
        'es': { name: 'Español', path: '/pages/es/' },
        'en': { name: 'English', path: '/pages/en/' },
        'de': { name: 'Deutsch', path: '/pages/de/' },
        'fr': { name: 'Français', path: '/pages/fr/' },
        'pt': { name: 'Português', path: '/pages/pt/' },
        'it': { name: 'Italiano', path: '/pages/it/' },
        'ja': { name: '日本語', path: '/pages/ja/' },
        'ru': { name: 'Русский', path: '/pages/ru/' },
        'zh': { name: '中文', path: '/pages/zh/' }
      };
      
      const DEFAULT_LANGUAGE = 'en';
      
      /**
       * Detect user's preferred language from multiple sources
       */
      function detectLanguage() {
        // 1. Check for manually selected language in localStorage
        const savedLang = localStorage.getItem('preferred_language');
        if (savedLang && SUPPORTED_LANGUAGES[savedLang]) {
          return savedLang;
        }
        
        // 2. Check browser languages
        const browserLangs = navigator.languages || [navigator.language || navigator.userLanguage];
        
        for (const browserLang of browserLangs) {
          // Extract primary language code (e.g., 'en-US' -> 'en')
          const langCode = browserLang.split('-')[0].toLowerCase();
          
          if (SUPPORTED_LANGUAGES[langCode]) {
            return langCode;
          }
        }
        
        // 3. Fallback to default
        return DEFAULT_LANGUAGE;
      }
      
      /**
       * Redirect to detected language page
       */
      function redirect() {
        const detectedLang = detectLanguage();
        const targetPath = SUPPORTED_LANGUAGES[detectedLang].path;
        
        // Get current path to preserve if user was navigating to a specific page
        const currentPath = window.location.pathname;
        const currentHash = window.location.hash;
        
        // Build redirect URL
        let redirectUrl = targetPath + 'index.html';
        
        // Preserve hash for deep linking
        if (currentHash) {
          redirectUrl += currentHash;
        }
        
        // Save detected language for future visits
        localStorage.setItem('preferred_language', detectedLang);
        
        // Perform redirect
        console.log(`Redirecting to ${SUPPORTED_LANGUAGES[detectedLang].name} (${detectedLang})`);
        window.location.replace(redirectUrl);
      }
      
      // Execute redirect after a brief moment to show loading screen
      setTimeout(redirect, 500);
      
    })();
  </script>
</body>
</html>
